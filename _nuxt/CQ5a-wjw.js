import{f as E,r as n,q as J,i as G,s as H,c as d,a as t,v as O,u as Y,n as l,x as L,y as p,z as i,A,C as R,d as M,D as Z,t as S,E as Q,o as m,_ as X}from"./g1nWQSka.js";import{u as _}from"./CBm0rI6g.js";import{u as ee}from"./B6vNXtVu.js";const te=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const le={class:"relative min-h-screen"},se=["src"],ae={class:"min-h-screen flex items-center justify-center"},oe={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"16",height:"16"},re={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",width:"16",height:"16"},ne=["type"],ie={class:"flex justify-between items-center text-sm text-slate-900 font-medium mb-4"},ue={class:"flex items-center"},de=["disabled"],pe={class:"text-base text-slate-900 text-center mt-5"},me={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"16",height:"16"},ce={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",width:"16",height:"16"},ve=["type"],fe=["disabled"],be={class:"text-base text-slate-900 text-center mt-5"},we={class:"flex justify-end gap-2"},ge=["disabled"],g="absolute left-2 top-1/2 -translate-y-1/2 text-base text-slate-900 font-medium pointer-events-none transition-all duration-300 peer-focus:-top-2 peer-focus:text-xs peer-placeholder-shown:top-1/2 peer-placeholder-shown:text-base peer-not-placeholder-shown:-top-2 peer-not-placeholder-shown:text-xs",x="relative w-full h-12 border-b-2 border-slate-900 mb-8",y="absolute right-2 top-1/2 -translate-y-1/2 text-xl text-slate-900",h="w-full h-full bg-transparent border-none outline-none text-base text-slate-900 font-semibold pl-2 pr-10 peer",xe=E({__name:"member",setup(ye){ee({title:"會員登入｜嘉義風景雲圖",meta:[{name:"description",content:"會員登入頁面，登入後可管理個人資料與專屬功能。"},{property:"og:title",content:"會員登入｜嘉義風景雲圖"},{property:"og:description",content:"會員登入頁面，登入後可管理個人資料與專屬功能。"},{property:"og:type",content:"website"}],script:[{src:"https://www.google.com/recaptcha/api.js",async:!0,defer:!0}]});const U=_(),u=n(!1),s=n({email:"",password:"",remember:!1}),r=n({username:"",email:"",password:"",agree:!1}),{login:q,register:F,user:N,resetPassword:D}=J(),V=Q(),c=n(!1),v=n(""),f=n(!1),b=n(!1),w=n(!1),C=n(!1),k=n(!1);G(()=>{if(te){const o=localStorage.getItem("loginForm");if(o){const e=JSON.parse(o);s.value.email=e.email||"",s.value.remember=e.remember||!1,e.remember&&(s.value.password=e.password||"")}}}),H(s,o=>{if(o.remember){const e={email:o.email,remember:o.remember};localStorage.setItem("loginForm",JSON.stringify(e))}else localStorage.removeItem("loginForm")},{deep:!0});function z(){u.value=!1,s.value={email:s.value.remember?s.value.email:"",password:"",remember:s.value.remember},r.value={username:"",email:"",password:"",agree:!1}}const T=/^[a-zA-Z0-9]{1,16}$/,$=/^[^\u4e00-\u9fa5]{1,30}$/,I=/^[a-zA-Z0-9\u4e00-\u9fa5]{1,10}$/;async function j(){var o;if(!$.test(s.value.email)){alert("郵件最多30個字且不能有中文");return}if(!T.test(s.value.password)){alert("密碼只能包含英文或數字,且最多16個字");return}if(!f.value){f.value=!0;try{await q(s.value.email,s.value.password);const e=((o=N.value)==null?void 0:o.displayName)||s.value.email;alert("歡迎回來，"+e),V.push("/memberCenter/center"),z()}catch{alert("登入失敗：帳號未註冊或密碼錯誤")}finally{setTimeout(()=>{f.value=!1},3e3)}}}function K(){return window.grecaptcha?window.grecaptcha.getResponse():""}async function B(){if(!I.test(r.value.username)){alert("使用者名稱只能包含英文、中文、數字,且最多10個字");return}if(!$.test(r.value.email)){alert("郵件最多30個字且不能有中文");return}if(!T.test(r.value.password)){alert("密碼只能包含英文或數字,且最多16個字");return}if(b.value)return;if(!K()){alert("請先通過機器人驗證");return}b.value=!0;try{await F(r.value.email,r.value.password,r.value.username),alert("註冊成功"),V.push("/memberCenter/center"),z(),window.grecaptcha&&window.grecaptcha.reset()}catch(e){alert("註冊失敗："+(e.message||e))}finally{setTimeout(()=>{b.value=!1},3e3)}}async function P(){if(!w.value){if(!v.value){alert("請輸入信箱");return}w.value=!0;try{await D(v.value),alert("重設密碼信已寄出，請檢查您的信箱（可能在垃圾郵件匣）"),c.value=!1,v.value=""}catch(o){alert("重設失敗："+(o.message||o))}finally{setTimeout(()=>{w.value=!1},5e3)}}}function W(){c.value=!1}return(o,e)=>(m(),d("div",le,[t("img",{src:Y(U),alt:"mountain",class:"absolute inset-0 w-full h-full object-cover -z-10 opacity-80"},null,8,se),t("div",ae,[t("div",{class:l([u.value?"min-h-[520px]":"min-h-[440px]","relative w-[400px] bg-white/25 border-1 border-gray-400 rounded-2xl backdrop-blur-lg shadow-xl flex justify-center items-center overflow-hidden transition-all duration-500 "])},[t("span",{class:"absolute top-0 right-0 w-12 h-12 bg-slate-900 text-white text-2xl justify-center items-center rounded-bl-2xl cursor-pointer z-10 hidden",onClick:z},e[14]||(e[14]=[t("ion-icon",{name:"close-outline"},null,-1)])),t("div",{class:l([u.value?"translate-x-[-400px] transition-none":"translate-x-0 transition-transform duration-200","form-box-login w-full p-10 absolute left-0 top-0"])},[e[21]||(e[21]=t("h2",{class:"text-2xl text-slate-900 text-center font-bold mb-6"},"登入",-1)),t("form",{onSubmit:p(j,["prevent"]),onKeyup:L(j,["enter"])},[t("div",{class:l(x)},[t("span",{class:l(y)},e[15]||(e[15]=[t("ion-icon",{name:"mail-outline"},null,-1)])),i(t("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=a=>s.value.email=a),required:"",placeholder:" ",class:l(h),autocomplete:"username"},null,512),[[A,s.value.email]]),t("label",{class:l(g)},"郵件:")]),t("div",{class:l(x),style:{position:"relative"}},[t("span",{class:l(y),style:{right:"8px"}},e[16]||(e[16]=[t("ion-icon",{name:"lock-closed-outline"},null,-1)])),t("span",{style:{position:"absolute",right:"38px",top:"50%",transform:"translateY(-50%)",cursor:"pointer","z-index":"2"},onClick:e[1]||(e[1]=a=>C.value=!C.value)},[C.value?(m(),d("svg",oe,e[17]||(e[17]=[t("circle",{cx:"256",cy:"256",r:"64",fill:"currentColor"},null,-1),t("path",{d:"M394.82 141.18C351.1 111.2 304.31 96 255.76 96c-43.69 0-86.28 13-126.59 38.48C88.52 160.23 48.67 207 16 256c26.42 44 62.56 89.24 100.2 115.18C159.38 400.92 206.33 416 255.76 416c49 0 95.85-15.07 139.3-44.79C433.31 345 469.71 299.82 496 256c-26.38-43.43-62.9-88.56-101.18-114.82zM256 352a96 96 0 1 1 96-96a96.11 96.11 0 0 1-96 96z",fill:"currentColor"},null,-1)]))):(m(),d("svg",re,e[18]||(e[18]=[t("path",{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07a32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z",fill:"currentColor"},null,-1)])))]),i(t("input",{type:C.value?"text":"password","onUpdate:modelValue":e[2]||(e[2]=a=>s.value.password=a),required:"",placeholder:" ",class:l(h),autocomplete:"current-password",style:{"padding-right":"70px"}},null,8,ne),[[R,s.value.password]]),t("label",{class:l(g)},"密碼:")]),t("div",ie,[t("label",ue,[i(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>s.value.remember=a),class:"accent-slate-900 mr-1.5"},null,512),[[Z,s.value.remember]]),e[19]||(e[19]=M("記住我"))]),t("a",{href:"#",class:"hover:underline",onClick:e[4]||(e[4]=p(a=>c.value=!0,["prevent"]))},"忘記密碼?")]),t("button",{type:"submit",disabled:f.value,class:"w-full h-11 rounded-md border-2 border-gray-400 hover:border-gray-700 transition-colors text-base font-medium cursor-pointer mt-4 mb-2"},S(f.value?"處理中...":"登入"),9,de),t("div",pe,[t("p",null,[e[20]||(e[20]=M("還沒有帳號? ")),t("a",{href:"#",class:"text-blue-600 font-semibold hover:underline",onClick:e[5]||(e[5]=p(a=>u.value=!0,["prevent"]))},"註冊")])])],32)],2),t("div",{class:l([u.value?"translate-x-0 transition-transform duration-200":"translate-x-[400px] transition-none","form-box-register w-full p-8 absolute left-0 top-0"])},[e[29]||(e[29]=t("h2",{class:"text-2xl text-slate-900 text-center font-bold mb-6"},"註冊帳號",-1)),t("form",{onSubmit:p(B,["prevent"]),onKeyup:L(B,["enter"])},[t("div",{class:l(x)},[t("span",{class:l(y)},e[22]||(e[22]=[t("ion-icon",{name:"person-outline"},null,-1)])),i(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=a=>r.value.username=a),required:"",placeholder:" ",class:l(h)},null,512),[[A,r.value.username]]),t("label",{class:l(g)},"使用者名稱")]),t("div",{class:l(x)},[t("span",{class:l(y)},e[23]||(e[23]=[t("ion-icon",{name:"mail-outline"},null,-1)])),i(t("input",{type:"email","onUpdate:modelValue":e[7]||(e[7]=a=>r.value.email=a),required:"",placeholder:" ",class:l(h),autocomplete:"username"},null,512),[[A,r.value.email]]),t("label",{class:l(g)},"郵件:")]),t("div",{class:l(x),style:{position:"relative"}},[t("span",{class:l(y),style:{right:"8px"}},e[24]||(e[24]=[t("ion-icon",{name:"lock-closed-outline"},null,-1)])),t("span",{style:{position:"absolute",right:"38px",top:"50%",transform:"translateY(-50%)",cursor:"pointer","z-index":"2"},onClick:e[8]||(e[8]=a=>k.value=!k.value)},[k.value?(m(),d("svg",me,e[25]||(e[25]=[t("circle",{cx:"256",cy:"256",r:"64",fill:"currentColor"},null,-1),t("path",{d:"M394.82 141.18C351.1 111.2 304.31 96 255.76 96c-43.69 0-86.28 13-126.59 38.48C88.52 160.23 48.67 207 16 256c26.42 44 62.56 89.24 100.2 115.18C159.38 400.92 206.33 416 255.76 416c49 0 95.85-15.07 139.3-44.79C433.31 345 469.71 299.82 496 256c-26.38-43.43-62.9-88.56-101.18-114.82zM256 352a96 96 0 1 1 96-96a96.11 96.11 0 0 1-96 96z",fill:"currentColor"},null,-1)]))):(m(),d("svg",ce,e[26]||(e[26]=[t("path",{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07a32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z",fill:"currentColor"},null,-1)])))]),i(t("input",{type:k.value?"text":"password","onUpdate:modelValue":e[9]||(e[9]=a=>r.value.password=a),required:"",placeholder:" ",class:l([h,"-pb-4"]),autocomplete:"new-password",style:{"padding-right":"70px"}},null,10,ve),[[R,r.value.password]]),t("label",{class:l(g)},"密碼:")]),e[28]||(e[28]=t("div",{class:"g-recaptcha mb-4","data-sitekey":"6LfUPHwrAAAAAAA6gtMft8t2-KWbgzqB09lL9oSJ"},null,-1)),t("button",{type:"submit",disabled:b.value,class:"w-full h-11 rounded-md border-2 border-gray-400 hover:border-gray-700 transition-colors text-base font-medium cursor-pointer"},S(b.value?"處理中...":"註冊"),9,fe),t("div",be,[t("p",null,[e[27]||(e[27]=M("已經有帳號? ")),t("a",{href:"#",class:"text-blue-600 font-semibold hover:underline",onClick:e[10]||(e[10]=p(a=>u.value=!1,["prevent"]))},"登入")])])],32)],2)],2)]),c.value?(m(),d("div",{key:0,class:"fixed inset-0 flex items-center justify-center bg-black/40 z-50",onClick:W},[t("div",{class:"bg-gray-200 border-1 border-gray-400 rounded-xl p-6 shadow w-80 animate-scale-in",onClick:e[13]||(e[13]=p(()=>{},["stop"]))},[e[30]||(e[30]=t("h3",{class:"text-lg font-bold mb-2"},"重設密碼",-1)),i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>v.value=a),type:"email",placeholder:"請輸入註冊信箱",class:"w-full border p-2 mb-3 rounded",onKeyup:L(P,["enter"])},null,544),[[A,v.value]]),t("div",we,[t("button",{onClick:e[12]||(e[12]=a=>c.value=!1),class:"px-3 py-1 transition hover:bg-gray-200 hover:shadow"},"取消"),t("button",{onClick:P,disabled:w.value,class:"px-3 py-1 bg-blue-600 text-white rounded transition hover:bg-blue-700 hover:shadow"},S(w.value?"處理中...":"送出"),9,ge)])])])):O("",!0)]))}}),Ae=X(xe,[["__scopeId","data-v-ea0708c9"]]);export{Ae as default};
